<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>轮播</title>
<style>
	body,div{margin:0;padding:0;}
	body{width:502px;height:372px;padding:5px;border:3px solid #ccc;margin:20px auto 0;}
	#box{width:500px;height:370px;position:relative;overflow:hidden;}
	#content{width:1000px;height:370px;position:absolute;top:0px;left:0;}
	#content img{width:500px;height:370px;float:left;}
	
	#prompt,#txt{width:500px;height:70px;position:absolute;top:300px; }
	#prompt{background:#000;opacity:0.4;}
	#txt{padding:10px;color:#fff;}
</style>
<script src="miaov.js"></script>
<script>
	window.onload = function(){
		var oCon = document.getElementById('content');
		var oPro = document.getElementById('prompt');
		var oTxt = document.getElementById('txt');
		var timer = '';
		
		var arrImg = ['../images/viwepager/1.jpg','../images/viwepager/2.jpg','../images/viwepager/3.jpg'];
		setCon(arrImg);
				
		timer = setInterval(function(){
			doMove(oPro,'top',5,370);
			doMove(oTxt,'top',5,370,function(){
				doMove(oCon,'left',15,-500,function(){
					
					var oneImg = arrImg.shift();	
					arrImg.push(oneImg);
					setCon(arrImg);
					
					oCon.style.left = '0px';
					doMove(oPro,'top',5,300);
					doMove(oTxt,'top',5,300);
				});
			});
		},2500)
		
		function setCon(arr){
			var str='';	
			for(var i=0;i<arr.length;i++){
				str += '<img src="'+arr[i]+'" />';
			}
			oCon.innerHTML = str;	
		}
	};
	
	function doMove ( obj, attr, dir, target, endFn ) {
	dir = parseInt(getStyle( obj, attr )) < target ? dir : -dir;
	clearInterval( obj.timer );
	obj.timer = setInterval(function () {
		var speed = parseInt(getStyle( obj, attr )) + dir;			// 步长
		if ( speed > target && dir > 0 ||  speed < target && dir < 0  ) {
			speed = target;
		}
		obj.style[attr] = speed + 'px';
		if ( speed == target ) {
			clearInterval( obj.timer );
			/*
			if ( endFn ) {
				endFn();
			}
			*/
			endFn && endFn(obj);
		}
	}, 30);
}

function getStyle ( obj, attr ) { 
	return obj.currentStyle?obj.currentStyle[attr] : getComputedStyle( obj )[attr]; 
}
</script>
</head>

<body>
	<div id="box">
    	<div id="content">
        </div>
        <div id="prompt"></div>
        <div id="txt">22222</div>
    </div>
</body>
</html>
